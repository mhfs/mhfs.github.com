---
layout: post
title: RMagick and Snow Leopard
tags: 
- mac osx
- development
- rmagick
---

"RMagick":http://rmagick.rubyforge.org/ is a RubyGem that wraps ImageMagick's features.

I never used it by myself but the project I'm working on uses a gem who depends on it.

I installed it twice. In the day I started working in the project and in my "dev env rebuild":http://mhfs.com.br/2010/02/01/rebuilding-my-dev-env.html last weekend. Both times it was a PITA. For different reasons.

The first time it was a conflict with a library MacPorts installed which I had to remove. Obviously after a lot of wasted hours.

This time it was a little bit harder to figure out. I installed ImageMagick via "Homebrew":http://github.com/mxcl/homebrew/ and then installed RMagick via gem install. The installation went well and I wrongly assumed everything was fine, but when I tried script/server I got a frozen process. No error messages.

After a lot of research I discovered that even though RMagick 2.12.2 (latest available gem) compile against ImageMagick 6.5.6 (the version Homebrew installs) it only works with ImageMagick >= 6.5.8. My work around was a customized Homebrew formula for 6.5.9.

So, after the story, let's make things happen.

Download the custom formula "here":http://gist.github.com/293828.

Someone told me brew install -i <formula> would work, but it didn't, so copy the file to /usr/local/Library/Formula/ and then:

{% highlight bash %}
$ brew install imagemagick_rmagick --with-ghostscript
$ gem install rmagick
{% endhighlight %}

That should make you ok.

*Ruby 1.8.6 note:* it seems ruby 1.8.6 has an issue with RMagick and Snow Leopard. You can see all the hardcore details "here":http://www.ruby-forum.com/topic/196606. It's safer to go with 1.8.7.

*Homebrew note:* I created an issue asking for a ImageMagick formula update. The custom formula won't be required soon.